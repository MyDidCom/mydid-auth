{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Verifiable Presentation schema",
  "type": "object",
  "required": ["@context", "type", "proof"],
  "additionalProperties": false,
  "properties": {
    "@context": {
      "type": "array",
      "minItems": 1,
      "uniqueItems": true,
      "items": {
        "type": "string"
      },
      "additionalProperties": false
    },
    "type": {
      "type": "array",
      "minItems": 1,
      "minContains": 1,
      "uniqueItems": true,
      "contains": {
        "type": "string",
        "enum": ["VerifiablePresentation", "CredentialManagerPresentation"]
      }
    },
    "id": {
      "type": "string",
      "pattern": "^(DID|did):(SDI|sdi):0x[a-fA-F0-9]{40}$"
    },
    "appBundleId": {
      "type": "string"
    },
    "verifiableCredential": {
      "type": "array",
      "items": {
        "anyOf": [
          {
            "type": "object",
            "title": "Verifiable Credential V1 schema",
            "required": [
              "@context",
              "type",
              "issuer",
              "issuanceDate",
              "credentialSubject",
              "credentialSchema",
              "proof"
            ],
            "properties": {
              "@context": {
                "type": "array",
                "minItems": 1,
                "uniqueItems": true,
                "items": {
                  "type": "string"
                },
                "additionalItems": false
              },
              "type": {
                "type": "array",
                "minItems": 1,
                "minContains": 1,
                "uniqueItems": true,
                "contains": {
                  "type": "string",
                  "enum": ["VerifiableCredential"]
                }
              },
              "issuer": {
                "type": "string",
                "pattern": "^(DID|did):(SDI|sdi):0x[a-fA-F0-9]{40}$"
              },
              "issuanceDate": {
                "type": "string",
                "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{0,6})?Z$"
              },
              "credentialSubject": {
                "type": "object",
                "required": ["id", "type", "image"],
                "properties": {
                  "id": {
                    "type": "string",
                    "pattern": "^(DID|did):(SDI|sdi):0x[a-fA-F0-9]{40}$"
                  },
                  "type": {
                    "type": "string"
                  },
                  "image": {
                    "type": "string"
                  }
                },
                "additionalProperties": true
              },
              "credentialSchema": {
                "type": "object",
                "required": ["id", "type"],
                "properties": {
                  "id": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string"
                  }
                },
                "additionalProperties": false
              },
              "proof": {
                "type": "object",
                "required": ["type", "created", "proofPurpose", "verificationMethod", "proofValue", "eip712"],
                "properties": {
                  "type": {
                    "type": "string"
                  },
                  "proofPurpose": {
                    "type": "string"
                  },
                  "created": {
                    "type": "string",
                    "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{0,6})?Z$"
                  },
                  "verificationMethod": {
                    "type": "string",
                    "pattern": "^(DID|did):(SDI|sdi):0x[a-fA-F0-9]{40}#(.+)$"
                  },
                  "proofValue": {
                    "type": "string"
                  },
                  "eip712": {
                    "type": "object",
                    "properties": {
                      "messageDataEip712Schema": {
                        "type": "string"
                      },
                      "domain": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string"
                          },
                          "chainId": {
                            "type": "integer"
                          },
                          "version": {
                            "type": "string"
                          }
                        },
                        "required": ["name", "chainId", "version"]
                      },
                      "primaryType": {
                        "type": "string",
                        "enum": ["VerifiableCredential"]
                      }
                    },
                    "required": ["messageDataEip712Schema", "domain", "primaryType"]
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          },
          {
            "type": "object",
            "title": "OpenBadge V3 schema",
            "required": [
              "@context",
              "mVersion",
              "id",
              "type",
              "issuer",
              "image",
              "name",
              "description",
              "templateHash",
              "issuanceDate",
              "credentialSubject",
              "credentialSchema",
              "proof"
            ],
            "properties": {
              "@context": {
                "type": "array",
                "minItems": 1,
                "uniqueItems": true,
                "items": {
                  "type": "string"
                },
                "additionalItems": false
              },
              "mVersion": {
                "type": "string",
                "pattern": "^3\\.[0-9]+$"
              },
              "id": {
                "type": "string"
              },
              "type": {
                "type": "array",
                "minItems": 2,
                "minContains": 2,
                "uniqueItems": true,
                "contains": {
                  "type": "string",
                  "enum": ["VerifiableCredential", "OpenBadgeCredential"]
                }
              },
              "issuer": {
                "type": "object",
                "required": ["id", "type"],
                "properties": {
                  "id": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string"
                  },
                  "name": {
                    "type": "string"
                  },
                  "endorsement": {
                    "type": "object",
                    "required": [
                      "@context",
                      "mVersion",
                      "id",
                      "type",
                      "issuer",
                      "image",
                      "templateHash",
                      "issuanceDate",
                      "expirationDate",
                      "credentialSubject",
                      "credentialSchema",
                      "proof"
                    ],
                    "properties": {
                      "@context": {
                        "type": "array",
                        "minItems": 1,
                        "uniqueItems": true,
                        "items": {
                          "type": "string"
                        },
                        "additionalItems": false
                      },
                      "mVersion": {
                        "type": "string",
                        "pattern": "^3\\.[0-9]+$"
                      },
                      "id": {
                        "type": "string"
                      },
                      "type": {
                        "type": "array",
                        "minItems": 2,
                        "minContains": 2,
                        "uniqueItems": true,
                        "contains": {
                          "type": "string",
                          "enum": ["VerifiableCredential", "EndorsementCredential"]
                        }
                      },
                      "issuer": {
                        "type": "object",
                        "required": ["id", "type", "name"],
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "type": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          }
                        },
                        "additionalProperties": false
                      },
                      "image": {
                        "type": "string"
                      },
                      "templateHash": {
                        "type": "string",
                        "pattern": "^0x[a-fA-F0-9]{64}"
                      },
                      "issuanceDate": {
                        "type": "string",
                        "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{0,6})?Z$"
                      },
                      "expirationDate": {
                        "type": "string",
                        "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{0,6})?Z$"
                      },
                      "credentialSubject": {
                        "type": "object",
                        "required": ["id", "type", "endorsementComment"],
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "type": {
                            "type": "string"
                          },
                          "endorsementComment": {
                            "type": "string"
                          },
                          "additionalProperties": false
                        }
                      },
                      "credentialSchema": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "required": ["id", "type"],
                          "properties": {
                            "id": {
                              "type": "string"
                            },
                            "type": {
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "proof": {
                        "type": "object",
                        "required": ["type", "created", "proofPurpose", "verificationMethod", "proofValue", "eip712"],
                        "properties": {
                          "type": {
                            "type": "string"
                          },
                          "proofPurpose": {
                            "type": "string"
                          },
                          "created": {
                            "type": "string",
                            "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{0,6})?Z$"
                          },
                          "verificationMethod": {
                            "type": "string",
                            "pattern": "^(DID|did):(SDI|sdi):0x[a-fA-F0-9]{40}#(.+)$"
                          },
                          "proofValue": {
                            "type": "string"
                          },
                          "eip712": {
                            "type": "object",
                            "properties": {
                              "messageDataEip712Schema": {
                                "type": "string"
                              },
                              "domain": {
                                "type": "object",
                                "properties": {
                                  "name": {
                                    "type": "string"
                                  },
                                  "chainId": {
                                    "type": "integer"
                                  },
                                  "version": {
                                    "type": "string"
                                  }
                                },
                                "required": ["name", "chainId", "version"]
                              },
                              "primaryType": {
                                "type": "string",
                                "enum": ["EndorsementCredential"]
                              }
                            },
                            "required": ["messageDataEip712Schema", "domain", "primaryType"]
                          }
                        },
                        "additionalProperties": false
                      }
                    },
                    "additionalProperties": false
                  }
                },
                "additionalProperties": false
              },
              "image": {
                "type": "string"
              },
              "name": {
                "type": "string"
              },
              "description": {
                "type": "string"
              },
              "templateHash": {
                "type": "string",
                "pattern": "^0x[a-fA-F0-9]{64}"
              },
              "issuanceDate": {
                "type": "string",
                "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{0,6})?Z$"
              },
              "credentialSubject": {
                "type": "object",
                "required": ["id", "type", "achievement"],
                "properties": {
                  "id": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string"
                  },
                  "name": {
                    "type": "string"
                  },
                  "achievement": {
                    "type": "object",
                    "required": ["id", "type", "criteria", "description", "name"],
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "type": {
                        "type": "string"
                      },
                      "criteria": {
                        "type": "object",
                        "properties": {
                          "narrative": {
                            "type": "string"
                          }
                        },
                        "required": ["narrative"],
                        "additionalItems": false
                      },
                      "description": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string"
                      }
                    },
                    "additionalItems": false
                  },
                  "additionalProperties": false
                }
              },
              "credentialSchema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": ["id", "type"],
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "type": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                }
              },
              "proof": {
                "type": "object",
                "required": ["type", "created", "proofPurpose", "verificationMethod", "proofValue", "eip712"],
                "properties": {
                  "type": {
                    "type": "string"
                  },
                  "proofPurpose": {
                    "type": "string"
                  },
                  "created": {
                    "type": "string",
                    "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{0,6})?Z$"
                  },
                  "verificationMethod": {
                    "type": "string",
                    "pattern": "^(DID|did):(SDI|sdi):0x[a-fA-F0-9]{40}#(.+)$"
                  },
                  "proofValue": {
                    "type": "string"
                  },
                  "eip712": {
                    "type": "object",
                    "properties": {
                      "messageDataEip712Schema": {
                        "type": "string"
                      },
                      "domain": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string"
                          },
                          "chainId": {
                            "type": "integer"
                          },
                          "version": {
                            "type": "string"
                          }
                        },
                        "required": ["name", "chainId", "version"]
                      },
                      "primaryType": {
                        "type": "string",
                        "enum": ["OpenBadgeCredential"]
                      }
                    },
                    "required": ["messageDataEip712Schema", "domain", "primaryType"]
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          },
          {
            "type": "object",
            "title": "Endorsement OpenBadge V3 schema",
            "required": [
              "@context",
              "mVersion",
              "id",
              "type",
              "issuer",
              "image",
              "templateHash",
              "issuanceDate",
              "expirationDate",
              "credentialSubject",
              "credentialSchema",
              "proof"
            ],
            "properties": {
              "@context": {
                "type": "array",
                "minItems": 1,
                "uniqueItems": true,
                "items": {
                  "type": "string"
                },
                "additionalItems": false
              },
              "mVersion": {
                "type": "string",
                "pattern": "^3\\.[0-9]+$"
              },
              "id": {
                "type": "string"
              },
              "type": {
                "type": "array",
                "minItems": 2,
                "minContains": 2,
                "uniqueItems": true,
                "contains": {
                  "type": "string",
                  "enum": ["VerifiableCredential", "EndorsementCredential"]
                }
              },
              "issuer": {
                "type": "object",
                "required": ["id", "type", "name"],
                "properties": {
                  "id": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string"
                  },
                  "name": {
                    "type": "string"
                  }
                },
                "additionalProperties": false
              },
              "image": {
                "type": "string"
              },
              "templateHash": {
                "type": "string",
                "pattern": "^0x[a-fA-F0-9]{64}"
              },
              "issuanceDate": {
                "type": "string",
                "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{0,6})?Z$"
              },
              "expirationDate": {
                "type": "string",
                "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{0,6})?Z$"
              },
              "credentialSubject": {
                "type": "object",
                "required": ["id", "type", "endorsementComment"],
                "properties": {
                  "id": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string"
                  },
                  "endorsementComment": {
                    "type": "string"
                  },
                  "additionalProperties": false
                }
              },
              "credentialSchema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": ["id", "type"],
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "type": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                }
              },
              "proof": {
                "type": "object",
                "required": ["type", "created", "proofPurpose", "verificationMethod", "proofValue", "eip712"],
                "properties": {
                  "type": {
                    "type": "string"
                  },
                  "proofPurpose": {
                    "type": "string"
                  },
                  "created": {
                    "type": "string",
                    "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{0,6})?Z$"
                  },
                  "verificationMethod": {
                    "type": "string",
                    "pattern": "^(DID|did):(SDI|sdi):0x[a-fA-F0-9]{40}#(.+)$"
                  },
                  "proofValue": {
                    "type": "string"
                  },
                  "eip712": {
                    "type": "object",
                    "properties": {
                      "messageDataEip712Schema": {
                        "type": "string"
                      },
                      "domain": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string"
                          },
                          "chainId": {
                            "type": "integer"
                          },
                          "version": {
                            "type": "string"
                          }
                        },
                        "required": ["name", "chainId", "version"]
                      },
                      "primaryType": {
                        "type": "string",
                        "enum": ["EndorsementCredential"]
                      }
                    },
                    "required": ["messageDataEip712Schema", "domain", "primaryType"]
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          }
        ]
      }
    },
    "proof": {
      "type": "object",
      "required": ["type", "created", "proofPurpose", "verificationMethod", "signatureValue", "challenge", "domain"],
      "properties": {
        "type": {
          "type": "string"
        },
        "proofPurpose": {
          "type": "string"
        },
        "created": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{0,6})?Z$"
        },
        "verificationMethod": {
          "type": "string",
          "pattern": "^(DID|did):(SDI|sdi):0x[a-fA-F0-9]{40}#(.+)$"
        },
        "signatureValue": {
          "type": "string"
        },
        "walletSignatureValue": {
          "type": "string"
        },
        "challenge": {
          "type": "string"
        },
        "domain": {
          "type": "string"
        }
      },
      "additionalProperties": false
    }
  }
}
